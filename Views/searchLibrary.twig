{% extends 'baseAdmin.twig' %}

{% block headScripts %}
    <style type="text/css">
        td label { 
           display: block;
           text-align: center;
        }
    </style>
{% endblock %}

{% block title %}{{title|default('Administration Dashboard')}}{% endblock %}
{% block breadcrumb %}
<ol class="breadcrumb">
    <li>
        <i class="fa fa-dashboard"></i>  <a href="/">Dashboard</a>
    </li>
    <li class="active">
        <a href="/library/search/"><i class="fa fa-tasks"></i>{% if search %}
        Library</a>
    </li>
    <li>
        <a href="/library/search/"><i class="fa fa-search"></i> Search</a>
        {% else %}
            Library</a>
        {% endif %}
    </li>
</ol>
{% endblock %}
{% block content %}
    {% if flash.error %}
        <div class="row">
            <div class="alert alert-danger">
                <strong>Error</strong> {{flash.error}}
            </div>
        </div>
    {% endif %}
    {% if flash.success %}
        <div class="row">
            <div class="alert alert-success">
                <strong>Success</strong> {{flash.success}}
            </div>
        </div>
    {% endif %}
    <form role="form" method="POST" action="/library/search/">
        <div class="row">
            <div class="form-group input-group">
                <input type="text" class="form-control" name="q" 
                       {% if search %}
                           value="{{search}}"
                       {% endif %}>
                <span class="input-group-btn"><button class="btn btn-default" type="button"><i class="fa fa-search"></i></button></span>
            </div>
        </div>
    </form>
    <form role="form" method="POST" action="/library/batch">
    <input type="hidden" name="_METHOD" value="PUT"/>
    <table class='table table-bordered table-hover' >
        <thead>
            {% if permissions > 1 or BulkEdit in permssions %}
            <th>
                <label><input type="checkbox" onClick="toggle(this)"> All</label>
            </th>
            {% endif %}
            <th><i class="fa fa-barcode "></i></th>
            <th><i class="fa fa-thumbs-o-up"></i></th>
            <th>Date In</th>
            <th>Artist</th>
            <th>Album</th>
            <th>Genre</th>
            <th>Year</th>
            <th>Notes</th>
        </thead>
        <tbody>
            {% for album in albums %}
                <tr>
                    {% if permissions > 1 or BulkEdit in permssions %}
                        <td>
                            <label><input type="checkbox" name="bulkEditId[]" value="{{album.RefCode}}"> {{album.RefCode}}</label>
                        </td>
                    {% endif %}
                    <td>
                        <button type="button" onclick="location.href='/library/{{album.RefCode}}';" class="btn btn-default btn-xs">
                            {% if not (permissions > 1 or BulkEdit in permssions) %}
                                {{album.RefCode}}
                            {% else %}
                                Edit
                            {% endif %}
                        <i class="fa fa-edit" aria-hidden="true"></i></button>
                    </td>
                    <td>{% if album.status == 1 %}
                        <i class="fa fa-check-circle-o" style="color: #008000"></i>
                        {% else %}
                            <i class="fa fa-times-circle-o" style="color: #800000"></i>
                        {% endif %}</td>
                    <td>{{album.datein}}</td>
                    <td>{{album.artist}}</td>
                    <td>{{album.album}}</td>
                    <td>{{album.genre}}</td>
                    <td>{{album.year}}</td>
                    <td>{% if album.note|length > 37 %}
                        {{album.note|striptags|slice(0,37)}}...
                        {% else %}
                            {{album.note}}
                    {% endif %}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    <div>
        <span>Batch Edit</span>
        <select name="action" required>
            <option value="">Select</option>
            <option value="print">Print</option>
            <option value="approve" disabled>Approve</option>
            <option value="reject" disabled>Reject</option>
        </select>
        <input type="submit" class="btn btn-primary btn-xs"/>
    </div>
{% endblock %}
{% block lastScripts %}
<script>
function toggle(source) {
    checkboxes = document.getElementsByName('bulkEditId[]');
    for(var i=0, n=checkboxes.length;i<n;i++) {
      checkboxes[i].checked = source.checked;
    }
  }
</script>
{% endblock %}
